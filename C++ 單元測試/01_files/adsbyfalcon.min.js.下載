/** @license: OpenAdViewability (BSD-3 License): https://github.com/picatcha/OpenAdViewability/ */
!function(){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function a(){this.getViewabilityState=function(t,e){var n,i=d();if(i.area===1/0)return{error:"Failed to determine viewport"};var r=t.getBoundingClientRect(),o=r.width*r.height,a=u(window.top),c=l(t,e);return n=i.area/o<.5?Math.floor(100*i.area/o):(c.bottom>a.height&&(c.height-=c.bottom-a.height),c.top<0&&(c.height+=c.top),c.left<0&&(c.width+=c.left),c.right>a.width&&(c.width-=c.right-a.width),Math.floor(c.width*c.height*100/o)),{clientWidth:a.width,clientHeight:a.height,objTop:r.top,objBottom:r.bottom,objLeft:r.left,objRight:r.right,percentViewable:n}};var d=function(){for(var t=u(window),e=t.area,n=window;n!==window.top;){n=n.parent;var i=u(n);i.area<e&&(e=i.area,t=i)}return t},u=function(t){var e={width:1/0,height:1/0,area:1/0};return!isNaN(t.document.body.clientWidth)&&0<t.document.body.clientWidth&&(e.width=t.document.body.clientWidth),!isNaN(t.document.body.clientHeight)&&0<t.document.body.clientHeight&&(e.height=t.document.body.clientHeight),t.document.documentElement&&t.document.documentElement.clientWidth&&!isNaN(t.document.documentElement.clientWidth)&&(e.width=t.document.documentElement.clientWidth),t.document.documentElement&&t.document.documentElement.clientHeight&&!isNaN(t.document.documentElement.clientHeight)&&(e.height=t.document.documentElement.clientHeight),t.innerWidth&&!isNaN(t.innerWidth)&&(e.width=Math.min(e.width,t.innerWidth)),t.innerHeight&&!isNaN(t.innerHeight)&&(e.height=Math.min(e.height,t.innerHeight)),e.area=e.height*e.width,e},l=function t(e,n){var i=n,r=n.parent,o={width:0,height:0,left:0,right:0,top:0,bottom:0};if(e){var a=h(e,n);if(a.width=a.right-a.left,a.height=a.bottom-a.top,o=a,i!==r){var c=t(i.frameElement,r);c.bottom<o.bottom&&(c.bottom<o.top&&(o.top=c.bottom),o.bottom=c.bottom),c.right<o.right&&(c.right<o.left&&(o.left=c.right),o.right=c.right),o.width=o.right-o.left,o.height=o.bottom-o.top}}return o},h=function t(e,n){var i=n,r=n.parent,o={left:0,right:0,top:0,bottom:0};if(e){var a=e.getBoundingClientRect();i!==r&&(o=t(i.frameElement,r)),o={left:a.left+o.left,right:a.right+o.left,top:a.top+o.top,bottom:a.bottom+o.top}}return o}}!function(u,l,r){function t(){}u.console=u.console||{log:t,warn:t,error:t,dir:t},Array.prototype.findIndex||(Array.prototype.findIndex=function(t){if(null==this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,r=arguments[1],o=0;o<i;o++)if(e=n[o],t.call(r,e,o,n))return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(t){if(null==this)throw new TypeError;var e,n,i,r=Object(this),o=r.length>>>0,a=[];if("function"!=typeof t)throw new TypeError;for(a=[],e=2<=arguments.length?arguments[1]:void 0,n=0;n<o;n++)n in r&&(i=r[n],t.call(e,i,n,r)&&a.push(i));return a}),u.requestAnimFrame=u.requestAnimFrame||u.requestAnimationFrame||u.webkitRequestAnimationFrame||u.mozRequestAnimationFrame||u.oRequestAnimationFrame||u.msRequestAnimationFrame||function(t){u.setTimeout(t,1e3/60)},u.cancelAFrame=u.cancelAnimationFrame||u.webkitCancelAnimationFrame||u.mozCancelAnimationFrame||u.oCancelAnimationFrame||function(t){u.clearTimeout(t)};var e=!1;function n(){}function i(){e||"loading"===l.readyState||(e=!0,u.setTimeout(function(){o(l)},0))}function o(t){var e,n,i,r,o=[],a=[],c=t.querySelectorAll("ins.adsbyfalcon");for(e=0,n=c.length;e<n;e++){var d,u=c[e],l=u.getAttribute("data-ad-slot"),h=E(u.getAttribute("data-ad-sizes")),s=u.getAttribute("data-merge-position"),f=u.getAttribute("data-next-position"),m=u.getAttribute("data-next-merge-position"),g=u.offsetWidth||0,p=u.offsetHeight||0;if(l&&!S(u,"processing")&&!M(u)){if(o.push(l),h&&(l=(d=w((i=y(h),void 0,r=v(),i.concat([r])).sort(x)))?d.slot:l),2199==l||1101==l||2268==l){var b=[{id:l,width:g,height:p,element:u,mergePosition:s}];A(u),_(b);continue}a.push({id:l,width:g,height:p,element:u,mergePosition:s,nextPosition:f,nextMergePosition:m}),A(u)}}o.length&&_(a)}function w(t){var e,n=v().width;if(1===(e=t.filter(function(t){return n>=t.width})).length)return(e=(e=t.reverse().slice(0,2)).filter(function(t){return{}.hasOwnProperty.call(t,"slot")}))[0];var i,r,o=e.findIndex(function(t){return!t.slot&&t.width===n}),a=o-1,c=o+1,d=t[o].width;return 0===o?e[1]:e.length-1===o?e[a]:(i=e[a].width,r=e[c].width,Math.abs(r-d)<Math.abs(i-d)?e[c]:e[a])}function v(){var t=Math.max(u.innerWidth,l.documentElement.clientWidth);return 793<=t&&t<=807&&(t=800),1017<=t&&t<=1031&&(t=1024),{width:t,height:Math.max(u.innerHeight,l.documentElement.clientHeight)}}function y(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push({resolution:e,slot:t[e],width:Math.floor(e.match(/^\d+/)[0]),height:Math.floor(e.match(/\d+$/)[0])});return n}function x(t,e){return t.width!==e.width?e.width>t.width?1:e.width<t.width?-1:0:e.height>t.height?1:e.height<t.height?-1:0}function h(t,e,n,i){if("false"===t.getAttribute("data-embed"))return t.innerHTML=i,void function t(e){if("SCRIPT"===e.tagName)return e.parentNode.replaceChild(a(e),e),e;var n=0,i=e.childNodes;u.pix&&"INS"===e.tagName&&e&&e.classList&&e.classList.add("pixnet-ad");for(;n<i.length;)t(i[n++]);return e}(t);u.pix&&t&&t.classList&&t.classList.add("pixnet-ad");var r=l.createElement("iframe"),o="margin:0;padding:0;overflow:hidden;background-color:transparent;";r.setAttribute("allowfullscreen","auto"),r.setAttribute("style",o+"border:none;width:"+e+"px;height:"+n+"px;"),r.setAttribute("scrolling","no"),t.innerHTML="",t.appendChild(r),r.contentDocument.open(),r.contentDocument.write(i),r.contentDocument.body&&r.contentDocument.body.setAttribute("style",o),r.contentDocument.close()}function a(t){var e=l.createElement("script");e.text=t.innerHTML;for(var n=t.attributes.length-1;0<=n;n--)e.setAttribute(t.attributes[n].name,t.attributes[n].value);return e}function _(e){var t,n="11"!==g("preview_mib_fly_mobile_image_ad")?g("demo_ad_no"):"75ecc55cd322ced48ae2d4c7717a0891",i=n?"&demo_ad_no="+n:"",r=f("falcon:blogcategory"),o=f("falcon:articlecategory"),a=u.location.origin.match(/(\.[0-9a-z_]+\.(alpha|test)\.pixnet(\.work)?$)/)||"",c="https";a&&(c="http",a=a[0]),t=c+"://"+(function(){for(var t=l.getElementsByTagName("script"),e=/\/\/([^.]*falcon)-asset\.pixfs\.net/g,n=0,i=t.length;n<i;n++){var r=e.exec(t[n].getAttribute("src"));if(r)return r[1]}}()||"falcon")+".pixnet.net"+a+"/ad/json?"+function(t){for(var e="",n=0,i=t.length;n<i;n++)e=e+s(t[n])+(n!==i-1?"&":"");return e}(e)+"&version=2&sdk_version=20210415v1&t="+(new Date).getTime()+i,r&&(t+="&blog_category="+r),o&&(t+="&article_category="+o),l.referrer&&(t+="&referrer="+encodeURI(l.referrer));var d=new XMLHttpRequest;u.XDomainRequest&&((d=new XDomainRequest).onprogress=function(){},d.ontimeout=function(){},d.onerror=function(){}),d.onload=function(){var t=E(this.responseText);(function(t){return t&&t instanceof Array})(t.ad_slots)&&t.ad_slots.length&&function(t,e){for(;e.length;){for(var n=e.shift(),i=t.shift();n.pos_id!==i.id;)i=t.shift();if(i&&!M(i.element)){if(0===n.ad_num){if(!i.nextPosition){var r=i.element.getAttribute("data-ad-passback");if(""!=r&&"function"==typeof u[r]){m(i.element),u[r](i.element);continue}i.element.parentNode.removeChild(i.element),-1!==["3869","3879","3874","3884"].indexOf(i.id)&&N(u,"activateInReadSticky")}"1101"!==i.id&&"2199"!==i.id&&"2268"!==i.id||(l.querySelector("#main > .header-fixed-area").style.display="none"),i.nextPosition&&(i.id=i.nextPosition,i.mergePosition=i.nextMergePosition,i.nextPosition="",i.nextMergePosition="",_([i]));continue}if(("2982"===i.id&&0<n.ad_list.length&&"3372"===n.ad_list[0].position_id||"3372"===i.id)&&i.element.parentNode&&i.element.parentNode.classList.contains("in-read-ad--sticky")&&i.element.parentNode.parentNode.classList.remove("disable-sticky"),"2982"===i.id&&0<n.ad_list.length&&"2982"===n.ad_list[0].position_id&&u.location.hostname==="falcondemo.pixnet.net"+pix.domain_append&&"on"===g("is_ignore_backdrop"))continue;h(i.element,i.width,i.height,n.html),m(i.element),void 0!==u.pix&&(("3869"===n.pos_id||"3879"===n.pos_id||"3874"===n.pos_id||"3983"===n.pos_id)&&0<n.ad_list.length&&"js"===n.ad_list[0].type?(o=n,void 0,(new Image).src=o.ad_list[0].activeview_url):p(i.element,n))}}var o}(e,t.ad_slots)},d.addEventListener&&d.addEventListener("error",function(){},!1),d.open("get",t,!0),d.withCredentials=!0,d.send()}function s(t){var e="";return t.mergePosition&&(e=","+t.mergePosition),"pos[]="+t.id+","+t.width+","+t.height+e}function f(t){var e=l.querySelector('meta[property="'+t+'"]');return e&&e.getAttribute("content")}function A(t){return c(t,"processing")}function M(t){return S(t,"done")}function m(t){return c(t,"done")}function S(t,e){return!!t&&e===t.getAttribute("data-adsbyfalcon-status")}function c(t,e){return!!t&&t.setAttribute("data-adsbyfalcon-status",e)}function E(t){try{return JSON.parse(t)}catch(t){return{}}}function g(t){if(!t)return"";for(var e=u.location,n=(e.search.substring(1)||e.hash.split("?")[1]||"").split("&"),i=0;i<n.length;i++){var r=n[i].split("=");if(r[0]===t)return decodeURIComponent(r[1].replace(/\+/g," "))}return""}function p(n,i){var r=n.querySelector("[data-falcon-ad], [data-falcon-ad-video]")||n.querySelector("img, iframe"),o=function(t){return!!t.match(/backdrop/)}(n.innerHTML),a=function(t){return!!t.match(/oneadIRDFPTag/)}(n.innerHTML),c=function(t){return!!t.match(/truvid/)}(n.innerHTML),t=function(t){return!!t.match(/popIn_recommend/)}(n.innerHTML),d="load";!t||r?r?0!==i.ad_list.length&&(n.querySelector("[data-falcon-ad-video]")&&(d="loadedmetadata"),r.addEventListener(d,function t(){var e=n.querySelector("[data-falcon-ad-container]")||r;o&&(e=n.querySelector("div[data-type]")),a&&(e=n.querySelector("#video_click_area0")),c&&(e=n.querySelector(".trvd_video_player")),b(e,i),r.removeEventListener(d,t,!1)})):n.addEventListener("DOMSubtreeModified",function t(){(n.querySelector("[data-falcon-ad], [data-falcon-ad-video]")||n.querySelector("img, iframe"))&&(p(n,i),n.removeEventListener("DOMSubtreeModified",t,!1))}):n.addEventListener("DOMSubtreeModified",function t(){n.removeEventListener("DOMSubtreeModified",t,!1),b(n,i)})}function b(t,e){var n=e.ad_list[0].activeview_url,i=new r;n&&i.checkViewability(t,function(t){t.viewabilityStatus&&((new Image).src=n)})}function N(t,e){var n=l.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}l.addEventListener("readystatechange",i),u.PIXFalcon=(n.prototype.placeAds=function(t){var e,n,i;if(l!==t){if(0!==(n=(e=l.querySelectorAll(t)).length))for(i=0;i<n;i++)o(e[i])}else o(l)},n.prototype.placeAdByNode=function(t){o(t)},n),i()}(window,document,function(){var m={percentObscured:0,percentViewable:0,acceptedViewablePercentage:50,viewabilityStatus:!1,duration:0};this.DEBUG_MODE=!1,this.checkViewability=function(r,o){var a=u(),c=this,d=window.requestAnimFrame(function t(){h(r)||(a=u(),l());var e=u()-a;var n=r.querySelector("[data-falcon-ad-video]")?2e3:1e3;var i=n<=e;m.duration=e;i?(m.viewabilityStatus=!0,c.DEBUG_MODE||window.cancelAFrame(d)):d=window.requestAnimFrame(t);o(m)});function u(){return"object"===t(window.performance)?window.performance.now():(new Date).getTime()}};var l=function(){m.percentObscured=0,m.duration=0,m.viewabilityStatus=!1},h=function(t){var e=t.getBoundingClientRect();return 242500<=e.width*e.height&&(m.acceptedViewablePercentage=30),!i(t)&&(!r(t)&&(!n(t).error&&(!(m.percentViewable&&m.percentViewable<m.acceptedViewablePercentage)&&m.percentViewable)))},n=function(t){var e=new a;m.percentObscured=m.percentObscured||0;var n=e.getViewabilityState(t,window);return n.error||(m.percentViewable=n.percentViewable-m.percentObscured),n},i=function(t){var e=window.getComputedStyle(t,null),n=e.getPropertyValue("visibility"),i=e.getPropertyValue("display");return"hidden"===n||"none"===i},r=function(t){var e=t.getBoundingClientRect(),n=e.left+12,i=e.right-12,r=Math.max(0,e.top+12),o=e.bottom-12,a=Math.floor(e.left+e.width/2),c=Math.floor(e.top+e.height/2),d=[{x:n,y:r},{x:a,y:r},{x:i,y:r},{x:n,y:c},{x:a,y:c},{x:i,y:c},{x:n,y:o},{x:a,y:o},{x:i,y:o}],u=[];for(var l in d)if(d.hasOwnProperty(l)&&d[l]&&0<=d[l].x&&0<=d[l].y){var h=document.elementFromPoint(d[l].x,d[l].y);if(p(t,h)){var s=h.getBoundingClientRect();if(e.top>s.bottom)continue;var f=b(e,s);if(0<f&&(g(u,h)||u.push({el:h,area:f}),m.percentObscured>100-m.acceptedViewablePercentage))return!0}}return m.percentObscured=0<u.length?100*u.map(function(t){return t.area}).reduce(function(t,e){return Math.max(t,e)}):0,m.percentViewable=100-m.percentObscured,!1},g=function(t,e){return 0<t.length&&t.map(function(t){return t.el}).some(function(t){return t===e})},p=function(t,e){return null!==e&&t!==e&&!t.contains(e)&&!e.contains(t)&&!o(t,e)},o=function(t,e){var n=e.nodeName,i=window.getComputedStyle(e,null),r=t.getBoundingClientRect(),o=e.getBoundingClientRect(),a=r.top===o.top&&r.bottom===o.bottom&&r.left===o.left&&r.right===o.right&&r.height===o.height&&r.width===o.width;return 0===e.childNodes.length&&("DIV"===n||"SPAN"===n)&&"none"===i.backgroundImage&&"none"===i.borderStyle&&"rgba(0, 0, 0, 0)"===i.backgroundColor&&a},b=function(t,e){var n=t.width*t.height;return Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left))*Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top))/n}})}();
